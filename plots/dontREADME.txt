Here be flowcharts, in an attempt to plot this mess in my head before it goes down the drain.
